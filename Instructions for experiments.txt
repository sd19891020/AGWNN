Overall experimental description:
(a) The data and codes are shared at https://github.com/sd19891020/AGWNN.
(b) Matlab software version requirement >= R2018a.
(c) Directory structure: The root directory stores the main runing files of Matlab, AGWNN and Common directories store Matlab source codes; DATA directory stores experimental data.
(d) Runing file naming format: main_exp{experiment serial number}_{experiment sub-serial number}_{experiment name}.m.
(e) In order to prevent misuse, the codes related to the output function have been commented, and the comments can be removed when using it. The examples are as follows: %save(agwnnpath,'AGWNNModel'); %WriteCsvData(outPath,titles,vals); .


Runing file list of experiment 1:
main_exp1_1_syn_make_data.m
main_exp1_2_syn_train.m
main_exp1_3_syn_obetas.m
main_exp1_4_syn_yhats.m
main_exp1_5_syn_betahats.m
main_exp1_6_syc_1000_yhstat.m

Runing file list of experiment 2:
main_exp2_1_pm25_train.m
main_exp2_2_pm25_yhats_statistics.m
main_exp2_3_pm25_yhats_scatter.m
main_exp2_4_pm25_betahat_and_yhat.m
main_exp2_5_pm25_yyhats_statistics.m

Runing file list of discussion:
main_exp3_1_gn_scale.m


Detailed experimental instructions:

Experiment 1.1, Construct synthetic datasets for different functions:
The ".\DATA\SYN\S{function index}.csv" file stores the synthetic sample datasets;
The ".\DATA\SYN\S5_1000.mat" file stores stores the synthetic sample data of 1000 sets.

Experiment 1.2, Train and store AGWNN model results:
Train the AGWNN model using AICc metrics and store the optimal model parameters in the ".\DATA\SYN\AGWNN_S{function index}.mat" file;
Store the Y, and YHat results in the ".\DATA\SYN\YYH_S{function index}.csv" file;
Store the AGWNN BetaHat, GWR BetaHat, and geographic coordinates in the ".\DATA\SYN\BHS_S5.mat" file.

Experiment 1.3, Draw the original Beta plot:
Read the ".\DATA\SYN\S5.csv" file;
Draw the figure of the original Beta.

Experiment 1.4, Draw estimation surfaces of models (MLR, ANN, GWR, GWANN, and AGWNN):
Read the ".\DATA\SYN\S{function index}.csv" and ".\DATA\SYN\YYH_S{function index}.csv" files;
Draw the comparison figure of YHats for different models.

Experiment 1.5, Compares the original Beta, GWR BetaHat, and AGWNN BetaHat:
Read the ".\DATA\SYN\S5.csv" and ".\DATA\SYN\BHS_S5.mat" files;
Draw the comparison figure of the original Beta, GWR BetaHat, and AGWNN BetaHat.

Experiment 1.6, Evaluates the predictive performance of the AGWNN model:
The ".\DATA\SYN\AGWNN_S5.mat" file stores the AGWNN model;
The ".\DATA\SYN\S5_1000.mat" file stores the 1000 groups of synthetic data;
Use the AGWNN model to calculate the prediction value of Y corresponding to the 1000 synthetic data, and store the statistical results in ".\DATA\SYN\AGWNN_STAT_1000.csv" file;
Store the statistical results (RMSE, and Pearson correlation coefficients) in files of ".\DATA\SYN\RMSE.csv", and ".\DATA\SYN\PR.csv".

Experiment 2.1, Train AGWNN models for four seasons in 2019:
".\DATA\PM25\NUVYXY_2019Q{season}.csv" store the variable data of the PM2.5-AOD model for four seasons;
".\DATA\PM25\GWRParm_2019Q{season}.mat" store the spatial bandwidth and BetaHat (GWR) of ground-based stations for four seasons;
Train the AGWNN models of four seasons in 2019 and store the optimal model parameters in files of ".\DATA\PM25\AGWNN_2019Q{season}.mat";

Experiment 2.2, Store YHat and statistical results for four seasons in 2019:
Store the results of Y and YHat in files of ".\DATA\PM25\YPY_2019Q{season}.csv";
Store the statistical results in files of ".\DATA\PM25\YPY_STAT.csv".

Experiment 2.3, Comparison of regression results of all models:
".\\DATA\\PM25\\YPY_2019Q{season}.csv" store the Y and YHat of MLR, ANN, GWR, GWANN, and AGWNN models;
Draw fitting scatter plots for MLR, ANN, GWR, GWANN, and AGWNN models.

Experiment 2.4, Mapping of local regression coefficients:
Store geographical coordinates, projected coordinates, Y, YHat, and BetaHat results in files of ".\DATA\PM25\UVYPYBETA_2019Q{season}.csv";
Draw the maps for local regression coefficients (Betas);
Draw the maps for PM2.5 estimation (YHat).

Experiment 2.5, Output the statistical results of Y and YHat:
".\DATA\PM25\NUVYXY_2019Q{season}.csv" store the variable Y of the PM2.5-AOD model for four seasons;
".\DATA\PM25\AGWNN_2019Q{season}.mat" store the YHat information;
Store the statistical results of Y and YHat in the ".\DATA\PM25\NUVYPY_STAT.csv" file.

Experiment in discussion, Compare the relationship between experimental and diagnostic training samples and regression ability:
Set different numbers of geographical neurons (400, 350, 300, 250, 200, and 150) to train the AGWNN models, and store the results in the files of ".\DATA\SYN\gn{number of geographical neurons}.mat";
Draw the comparison figure of the performance and efficiency of the models under different training samples.

















